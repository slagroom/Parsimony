trigger:
- master

pool:
  vmImage: 'ubuntu-latest'

variables:
  GitVersion.SemVer: ''

steps:
- task: DotNetCoreCLI@2
  displayName: dotnet test
  inputs:
    command: test
    publishTestResults: true
- task: UseGitVersion@5
  displayName: gitversion
  inputs:
    versionSpec: '5.x'
- task: DotNetCoreCLI@2
  displayName: dotnet pack
  inputs:
    command: pack
    versioningScheme: 'byPrereleaseNumber'
    majorVersion: '$(GitVersion.Major)'
    minorVersion: '$(GitVersion.Minor)'
    patchVersion: '$(GitVersion.Patch)'
    packDirectory: '$(Build.ArtifactStagingDirectory)'
- task: PublishBuildArtifacts@1
  inputs:
    pathtoPublish: '$(Build.ArtifactStagingDirectory)'
    artifactName: 'package'
